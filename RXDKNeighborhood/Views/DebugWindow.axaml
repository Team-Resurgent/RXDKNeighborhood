<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:RXDKNeighborhood.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1024" d:DesignHeight="768"
        x:Class="RXDKNeighborhood.Views.DebugWindow"
        x:DataType="vm:DebugWindowViewModel"
        Width="1024" Height="768"
        Icon="/Assets/icon.ico"
        Title="{Binding Title}">

        <Design.DataContext>
            <!-- This only sets the DataContext for the previewer in an IDE,
             to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
            <vm:DebugWindowViewModel/>
        </Design.DataContext>

    <DockPanel Margin="10">
        <StackPanel DockPanel.Dock="Top" Margin="0,0,10,10" Orientation="Horizontal" Spacing="10">
            <Button IsVisible="{Binding ShowMenu}" ToolTip.Tip="Load Pdb" Height="40" FontSize="20" FontWeight="Regular" FontFamily="{StaticResource MaterialSymbols}" VerticalContentAlignment="Center" Content="&#xf720;" Command="{Binding LoadPdbCommand}"/>
            <Button ToolTip.Tip="Clear Log" Height="40" FontSize="20" FontWeight="Regular" FontFamily="{StaticResource MaterialSymbols}" VerticalContentAlignment="Center" Content="&#xe872;" Command="{Binding ClearLogCommand}"/>
            <Button IsEnabled="{Binding PdbLoaded}" ToolTip.Tip="Add Breakpoint" Height="40" FontSize="20" FontWeight="Regular" FontFamily="{StaticResource MaterialSymbols}" VerticalContentAlignment="Center" Content="&#xf49c;" Command="{Binding AddBreakpointCommand}"/>
            <Button IsEnabled="{Binding IsStopped}" ToolTip.Tip="Continue" Height="40" FontSize="20" FontWeight="Regular" FontFamily="{StaticResource MaterialSymbols}" VerticalContentAlignment="Center" Content="&#xe037;" Command="{Binding ContinueCommand}"/>
        </StackPanel>

        <StackPanel DockPanel.Dock="Bottom" Orientation="Vertical" Margin="0,10,0,0">
            <Label Content="Breakpoints:"></Label>
            <DataGrid ItemsSource="{Binding Breakpoints}" IsReadOnly="True" CanUserResizeColumns="True" GridLinesVisibility="All" BorderThickness="1" BorderBrush="Gray" Height="150">
                <DataGrid.Styles>
                    <Style Selector="DataGridRow">
                        <Setter Property="ContextMenu">
                            <Setter.Value>
                                <ContextMenu>
                                    <MenuItem Header="Remove Breakpoint" 
                                              Command="{Binding $parent[Window].DataContext.RemoveBreakpointCommand}" 
                                              CommandParameter="{Binding}"/>
                                </ContextMenu>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </DataGrid.Styles>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Line" Binding="{Binding Line}" />
                    <DataGridTextColumn Header="File" Binding="{Binding File}" />
                    <DataGridTextColumn Header="Virtual Address" Binding="{Binding VirtualAddressString}" />
                </DataGrid.Columns>
            </DataGrid>
        </StackPanel>
        
        <Border BorderThickness="1" BorderBrush="Gray">
            <ScrollViewer x:Name="LogScrollViewer" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                <TextBox Name="Viewer" IsReadOnly="True" BorderThickness="0" TextWrapping="NoWrap" Text="{Binding DebugLog}" />
            </ScrollViewer>
        </Border>
    </DockPanel>
</Window>
